// /paginasweb1/js/main.min.js
document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("main-header");e&&window.addEventListener("scroll",()=>{window.scrollY>32?e.classList.add("scrolled"):e.classList.remove("scrolled")});const t=document.getElementById("current-year");t&&(t.textContent=(new Date).getFullYear());const n=document.querySelector(".fab-main"),o=document.querySelector(".fab-container"),a=document.querySelector(".fab-call");n&&o&&(n.addEventListener("click",()=>{o.classList.toggle("open"),n.setAttribute("aria-expanded",o.classList.contains("open").toString())}),a&&("ontouchstart"in window||navigator.maxTouchPoints>0?a.style.display="flex":a.style.display="none"));const c=document.querySelectorAll(".testimonial-slider");c.forEach(e=>{let t=0;const n=e.querySelectorAll(".testimonial-slide"),o=e.querySelector(".prev"),a=e.querySelector(".next");function c(e){n.forEach(e=>e.classList.remove("active")),n[e].classList.add("active")}o&&a&&(o.addEventListener("click",()=>{t=(t-1+n.length)%n.length,c(t)}),a.addEventListener("click",()=>{t=(t+1)%n.length,c(t)}),n.length>0&&c(0))});const r=document.querySelectorAll('form[action="php/enviar-correo.php"]');function s(e,t,n){fetch("php/enviar-correo.php",{method:"POST",body:t}).then(e=>e.json()).then(t=>{t.success?(n.textContent=t.message,n.classList.add("success"),e.reset()):(n.textContent=t.message+(t.errors?": "+Object.values(t.errors).join(", "):""),n.classList.add("error")),n.style.display="block",n.setAttribute("aria-live","assertive")}).catch(e=>(console.error("Error en fetch:",e),n.textContent="Hubo un error al enviar el mensaje. Inténtalo más tarde.",n.classList.add("error"),n.style.display="block",n.setAttribute("aria-live","assertive")))}r.forEach(e=>{e.addEventListener("submit",function(t){t.preventDefault();const n=this,o=n.querySelector(".form-message");o.style.display="none",o.className="form-message",o.removeAttribute("aria-live");const a=new FormData(n);if(n.querySelector("#recaptchaResponseIndex")||n.querySelector("#recaptchaResponseContact")){const t=n.id.includes("index")?"recaptchaResponseIndex":"recaptchaResponseContact";if("undefined"!=typeof grecaptcha&&grecaptcha.enterprise)grecaptcha.enterprise.ready(()=>{grecaptcha.enterprise.execute("TU_SITE_KEY_RECAPTCHA_V3",{action:"submit"}).then(c=>{document.getElementById(t).value=c,s(n,a,o)})});else return console.error("reCAPTCHA script no cargado o no es enterprise."),o.textContent="Error de reCAPTCHA. Intenta de nuevo.",o.classList.add("error"),o.style.display="block",void o.setAttribute("aria-live","assertive")}else s(n,a,o)})});const i=document.querySelector(".mobile-nav-toggle"),l=document.querySelector("#main-header nav");i&&l&&(i.addEventListener("click",()=>{l.classList.toggle("active"),i.setAttribute("aria-expanded",l.classList.contains("active").toString())}));const d=document.querySelector(".blog-posts-container"),m=document.getElementById("prev-page"),u=document.getElementById("next-page"),g=document.getElementById("current-page-display");if(d&&m&&u&&g){let e=1;const t=3,n=Array.from(d.children),o=Math.ceil(n.length/t);function a(){const c=n.slice((e-1)*t,e*t);n.forEach(e=>e.style.display="none"),c.forEach(e=>e.style.display="block"),g.textContent=`Página ${e} de ${o}`,m.disabled=1===e,u.disabled=e===o,m.setAttribute("aria-disabled",m.disabled.toString()),u.setAttribute("aria-disabled",u.disabled.toString()),c.length>0&&c[0].querySelector("a")?.focus()}n.length>0?(a(),m.addEventListener("click",()=>{e>1&&(e--,a())}),u.addEventListener("click",()=>{e<o&&(e++,a())})):(m.style.display="none",u.style.display="none",g.style.display="none")}});